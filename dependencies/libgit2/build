#!/bin/bash

# Build libgit2 for the host operating system and the host architecture.

# Clean any previous output.
rm -rf auto/include/*
rm -rf auto/lib/*

# Go to the root directory where to work from.
cd ..
cd libgit2*

# Clean / create build directory.
rm -rf build
mkdir build
cd build

# Configure builder.
cmake .. -DBUILD_SHARED_LIBS=OFF -DBUILD_CLAR=OFF -DTHREADSAFE=ON

# Build library.
cmake --build .

# Copy the output to the desktop.
mkdir -p ../../auto/auto/include
cp -r ../include/* ../../auto/auto/include
mkdir  -p ../../auto/auto/lib
cp libgit2.a ../../auto/auto/lib
cd ..

# Clean build directory.
rm -rf build

echo If everything went well, then libgit2 has been built.
echo The output was copied to auto/auto.
