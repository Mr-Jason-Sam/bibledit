#!/bin/bash

# Clean any previous output.
rm -rf x86_64/include/*
rm -rf x86_64/lib/*

# Go to the root directory where to work from.
cd ..
cd libgit2*

# Clean / create build directory.
rm -rf build
mkdir build
cd build

# Configure builder.
cmake .. -DBUILD_SHARED_LIBS=OFF -DBUILD_CLAR=OFF -DTHREADSAFE=ON

# Build library.
cmake --build .

# Copy the output to the desktop.
mkdir -p ../../osx/x86_64/include
cp -r ../include/* ../../osx/x86_64/include
mkdir  -p ../../osx/x86_64/lib
cp libgit2.a ../../osx/x86_64/lib
cd ..

# Clean build directory.
rm -rf build

echo If everything went well, then libgit2 has been built for OS X.
echo The output was copied to osx/x86_64.
