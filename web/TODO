To automatically import translated templates from launchpad.
bzr pull lp:~teusbenschop/bibledit/bibledit-pot
bzr init

The site needs to have the concept of Desktops. Users can create store and erase these. 
E.g. a desktop for editing, one for merging, etc.
The desktops contain any number of screens or tools that the translator or consultant can use.
There are standard Desktops included in the default application.
When editing desktops the user can choose in which menu it will be displayed, and it will be displayed there.

Creating desktop "text".

There are some standard desktops defined, which the user cannot modify.
Objects are called that do the rendering.











The navigator should respond to a new focus available from IPC, and then move to the new location.
This requires AJAX long polling. 

Messaging between applications and server for e.g. verse reference, and many other things, 
e.g. lists of verses to be sent to the references window.

The text editor needs a link that sets the default / focused bible, so that the navigator takes that bible.
But for as long as the navigator is not yet separated, then this is not needed, but we should prepare for it in the code.





When collaborating, or setting it up, we need to set the php time out to 0 (inifinite)
Or better still would be to do as launchpad does, to start an independent process, and to monitor that through the page
and ajax polling.
This way there cannot be any timeouts, and the apache server remains free do continue serving other processes.





To add the bibledit-web concept to the wiki, or even Bibledit-Web's online help itself.






















Formatted mode, route for implementation.

Each line, as in standard USFM display, becomes a link.

If the link is clicked, it gives the relevant raw USFM code, with a Save button.

Each link, when clicked, has a reference to the line number, so saving it knows where to insert this line
in the existing chapter data.

It needs a separate module for USFM view, and another module for formatted view.

The navigator needs to be separated, or at least, to be made a proper object that can be included
when only one module shows, such as it is now in usfm view.
So there should be a separate smarty renderer for the navigator,
first the smarty renders the top bit, then the navigator to be inserted, then finally the bottom bit.

The various modules need to use AJAX long polling to find out where to move the cursor to.

If the user clicks on a link in the editor, and this belongs to a certain verse, then the navigator 
should also be updated to show this verse.


















The idea behind Bibledit-Web is that various users can log into the application, and that each user has a certain "level" within the application. This level will give him or her more or less rights.

1. There's the most basic level, which is "Visitor". A visitor can be anybody, or search engines, who visit the site. Visitors should be able to see the Bibles being translated on the site. #

2. The next level is a "Member". A member is somebody who has signed up to the site, and has confirmed this signup through his email. This is an independent process, which means whoever wants can become a "Member". Members will be able to do the same as Visitors, but in addition they will be able to raise Issues or "Consultation Notes" on the site. These notes presumably will be about how a certain passage has been translated. Members should be able to subscribe to changes in the Bible, and to changes in Consultation Notes, so that they are notified by email about this.

3. Then, again the next level, there can be a "Consultant". Consultants are people who can be consulted because of there knowledge of the original language such as Hebrew or Greek, or because of their knowledge of their target language in case they are language scholars, or for any other knowledge they have. Nobody can become a Consultant by himself, this level is assigned to him by the Manager.

4. The next level is "Translator". These are the ones that have all the rights of the Consultant, but in addition can actually change the Bible text.

5. Then there's the "Manager". The manager has all the privileges of the previous levels, but in addition can add books to the Bible, delete books, add chapters, copy Bibles, and so on. The manager can assign privileges to the translators, consultants, and so on.

6. Finally, there is the "Administrator". The administrator has all rights to do anything, and will do the technical setup and maintenance of the site.



If a Bible translation work is collaborated in public domain, it could be too hard come up with one
translation for every verse. It  is too bad to split the team and make a copy of the web application 
every time they can not come up with a common translation. So I am assuming that branching at verse level
should be supported and the final outputs (like whole OSIS, let me call it "a distribution") should also be plural. 
And for each distribution should choose branched verses to take which version.



Just a thought here, but I think it might be good to have the option for administrators to chose which rights go to whom. 
E.g. I'm not sure a new translation really should be immediately available to anyone ("visitor"). 
It may invite premature comments or criticism that would slow the process down. 
Or perhaps visitors could be prevented entirely until a certain phase when the administrator chooses
to disclose translation content.












The book names are not localized as we do in bibledit-linux, but localization uses the existing mechanism.
It works through gettext. For that reason a php file needs to be created that contains all existing English books.
This file is to be generated somehow by the system admin, and this file can be stored among the source code.
Thus the gettext system will be filled with that data, and can get translated.
If somebody wants the localized Bible names, but does not translate the whole site, it suffices to only translate 
the relevant bits in the po file.













* There's one table that never changes, and it contains the current database schema version number, an integer.
* Each object that encapsulates a table also stores the actual version number as a constant. 
* It compares it with the stored version number, and if there are differences, it performs an upgrade.





Pay attention to internationalization.
We need to get gettext working, and so need to have accounts where the user can set his language.
The administrator sets the default language for the site for guests and before login.


On Ubuntu for extra locales, install packages like "language-pack-*". After installing a new pack, run "locale-gen" and restart Apache (sudo apache2ctl restart)
to make this new locale to take effect. This should go in the installation manual.


To go through the various php functions called and read the comments, and learn from it.
setlocale(LC_ALL, ""); Takes the locale from the environment.
Before setting the locale, the php page runs 'locale -a' to see the available locales on the system.
Then, it needs to check whether bibledit provides this translation, and advise the user appropriately.

A little function to test available locales on a sytem :
<?php
function list_system_locales(){
    ob_start();
    system('locale -a'); 
    $str = ob_get_contents();
    ob_end_clean();
    return split("\\n", trim($str));
}

$locale = "fr_FR.UTF8";
$locales = list_system_locales();

if(in_array($locale, $locales)){
        echo "yes yes yes....";
}else{
        echo "no no no.......";
}
?>


It may use the available locales for dates and number representation as are on the system, and use our own locales 
as come with the application.
These two catalogs are different.


When setting translation domains in the preferences, do a check on the functions' return values if it worked out well.


The administrator can leave the locale empty, in which case the system locale will be taken. This should be the default for local installations.



The site has one default translation, set by the site administrator. Visitors get to see this default translation.

The purpose of the site is to inform the public about a translation in progress and to sollicit their input.
The 'consultation notes' on the site work in a special way. Contributors are invited to open an account on the site in order to contribute.
Consultation notes can be assigned to one or more persons. If a note is assigned to a person, then this person gets emailed.
But also, more importantly, the person will get reminders after e.g. a week, two weeks, a month. The person can set the frequency of
the reminders but not less often than once a month or two months on the most. This is the result that persons get regularly reminded if their
note has not been resolved. It is more a task than a note. Persons should also be able to click the 'resolved' button, which will 
automatically unassign it to him, and re-assign it to the 'team'. Borrow reasonably from a tickets system that may already be there.
There is also an array of users whose response is requested for this ticket, and reminders go to them till they respond by email or switch 
this flag off: Don't bother me with this ticket. If this flag is switched off by them, then they are regarded to have responded without a vote.
There is an external email account where email responses can go to, and this account is regularly checked by bibledit.
The ticket / issues trackers differs in model to the current system. The current system shares the notes, but the new system has a ticket number, 
with a variety of comments to it, and status. See the standard ticets systems. There should be a way to import the old system into the new.
The new should be shared also.


Make our own modular system, loosely coupled, so that we create a new applicaton for each module, 
* and share the library for all, and any of our own classes.
All these applications together form "bibledit", a loosely coupled modular lot of software.





When running a local web server, as many will do, and syncing data files of projects and notes with bibledit's repository, 
Or better could be even to have bibledit to sync its files through the web server, so permission will never be a problem.


To have a Twitter module, that can send changes to twitter in a meaningful way.


To have a module that creates a new GoBible each hour if there were changes. The user also can request to make a module "now", 
which will be scheduled for the next minute. If there were no changes, it indicates this as well. There is also a very simple page for 
access from cell phones.


People with an account can subscribe to changes in the text, and to changes in the project notes. This is done in their account, under their
email preferences.


JavaScript library jquery.com is recommended.


Files in the web root should be given such a mode that these cannot be read from outside, only from inside.
This is: file permissions to -r--------.


The visitor to the site can see the default project, its text and comments. But to make comments, one has to get an account.
Those with an account have vastly improved opportonities on the site.


If a new version is installed, and routines are to be done, to be sure it always installs a file as a flag.
When this flag is found, the site says that after maintenance by the administrator it runs again (or similar).




















MySQL does not start on Ubuntu 9.10:
This problem can be solved by removing some mysql-related components :

sudo apt-get remove mysql-admin mysql-query-browser mysql-gui-tools-common mysql-client-5.0 libmysqlclient15off

and installing mysql server

sudo apt-get install mysql-server mysql-client mailutils



Windows: http://www.wampserver.com/
Or: http://www.apachefriends.org/en/xampp-windows.html


Being behind a shaking connection, the site should be operatable by email as well, in particular the consultations.


Instead of using XeTeX, we could also look at CSS2 with paged media for printing, and screen media for the screen.








Where help is needed: 
Would need to write the software for the project under the GPL, stated in each source file.
Could fully test current source on Windows, describe how to install it, 
and create a Windows installer and describe how to do that through open source tools. 
Same for Macintosh. 
Would communicate through bibledit-development. 
Would write documentation on the Wiki. 
Could write manuals for how to work with Bibledit-Web. 
Could make a start with an issues tracker that is compatible with Bibledit-Gtk's project notes. 
He could enable internationalization and localization with a language setting in the user preferences, 
and a language setting for the site administrator for the site's language if the user has not yet logged in.






Bibledit-Web should have an administrative possibility to set the text that displays on the site to 
people not yet logged in, or logged out.




